<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport"
			content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<script type="text/javascript" src="js/jquery-1.9.1.js"></script>
		<script type="text/javascript" src="config.js"></script>
		<style>
			* {
				margin: 0;
				padding: 0;
			}

			.check-model-list {
				display: flex;
				align-content: center;
			}

			.check-model-list p {
				width: 200px;
				cursor: pointer;
				border: 1px solid #E95223;
				padding: 10px;
				text-align: center;
				margin-bottom: 12px;
			}

			.check-model-list p:nth-child(1) {
				border-right: 0;
			}

			.check-model-list p.active {
				background: #E95223;
				color: #fff;
			}

			.wrap_up {
				padding: 10px;
			}

			h2 {
				margin-bottom: 10px;
			}

			ul {
				display: flex;
				align-items: center;
				flex-wrap: wrap;
			}

			ul li {
				background-color: #e9e9eb;
			}

			ul.red li.current {
				background-color: #E95223;
			}

			ul.blue li.current {
				background-color: #F2C811;
			}

			ul li {
				list-style: none;
				width: 40px;
				height: 40px;
				border-radius: 50%;
				line-height: 40px;
				text-align: center;
				color: #fff;
				margin-right: 1px;
				margin-bottom: 6px;
				font-weight: bold;
			}

			button {
				display: block;
				width: 150px;
				height: 50px;
				margin: 10px auto;
				border: 0;
				font-size: 20px;

			}

			#styleTopHight {
				height: 18px;
			}
		</style>
	</head>
	<body>
		<div class="wrap_up">
			<h5 id="styleTopHight"></h5>
			<div id="modeList" class="check-model-list"></div>
			<div id="dynamic">
				<h2>å‰åŒº</h2>
				<ul id="red" class="red"></ul>
				<h2>ååŒº</h2>
				<ul id="blue" class="blue"></ul>
			</div>
		</div>


		<!-- 		<div id="showLuck">
			<div id="gua1" style="width:510px;;margin:0 auto;">
				<div id="show" style="position:absolute;display:none;" align="center">
				</div>
				<img id="gua1_img" class="xiangpicls" src="img/gua_image.png" style="position: absolute;">
				<canvas id="front" class="xiangpicls" style="position:absolute;no-repeat;z-index:1005;" />
			</div>
			<div class="keBottom">
				<div class="resetbtn">å†åˆ®ä¸€æ¬¡</div>
			</div>

		</div> -->

		<div id="showLuck">
			<div class="choice">
              
				<form name="config">
					é€‰æ‹©æ€»å¼ æ•°
					<select name="class"> </select>
				</form>

			</div>


			<div class="student"><span id="name">0</span></div>
			<div class="button-wrap">
				<button class="default-button" type="button" onclick="clickButton()">å¼€å§‹é€‰æ‹©</button>
			</div>
			<div class="copyright">
				<span></span>
			</div>
			<script src="js/students.js"></script>
			<script type="text/javascript" src="js/main.js"></script>

		</div>

		<script src="js/bd.js"></script>
		<script>
			document.getElementById('dynamic').style.display = "none";
			// çº¢çƒä»1 - 33 ä¸­é€‰æ‹© 6 ä¸ª
			// è“çƒä»1 - 16 ä¸­é€‰æ‹© 1 ä¸ª
			let options = {
					redLength: 33,
					redLuck: 6,
					blueLength: 16,
					blueLuck: 1
				},
				options2 = {
					redLength: 35,
					redLuck: 5,
					blueLength: 12,
					blueLuck: 2
				},
				activeList = ['1', '2', '3'],
				//é¦–å…ˆå±•ç¤º
				active = '3',
				modeListShow = document.getElementById("modeList");

			// æ¸²æŸ“æ¨¡å¼
			function dynamic(choice) {

				if (choice == 3) {
					document.getElementById('dynamic').style.display = "none";
					document.getElementById('showLuck').style.display = "block";
					console.log("éšè—æ‰§è¡Œ")
				}

				if (choice == 1) {
					document.getElementById('dynamic').style.display = "block";
					document.getElementById('showLuck').style.display = "none";

				}
				if (choice == 2) {

					document.getElementById('dynamic').style.display = "block";
					document.getElementById('showLuck').style.display = "none";
				}

			}

			const renderModel = (model) => {
				//return `<p titleText="${model}" class="model-item  ${active === model && 'active'}">${model === '1' ? 'åŒè‰²çƒ' : 'å¤§ä¹é€'}</p>`

				return `<p titleText="${model}" class="model-item 
				 
				 ${active === model && 'active'}"  > ${model ==='3'  ?  'ğŸ˜/ğŸ™‚' : model === '1' ? '2/4/æ—¥' : '1/3/6'} </p>` //æ¡ä»¶é€‰æ‹©å™¨å¤šé‡ä½¿ç”¨

			}
			const renderModelOption = () => {
				modeListShow.innerHTML = activeList.reduce((a, b) => {
					a += renderModel(b)

					return a
				}, '')
			}
			// åˆ‡æ¢æ¨¡å¼
			modeListShow.addEventListener('click', (e) => {
				let choice = e.target.getAttribute('titleText')
				//if (model === active || model === null) return

				console.log(choice)

				//æ˜¾ç¤º1
				if (choice == 1) {
					dynamic(choice);
					active = choice
					Array.from(document.getElementsByClassName('model-item')).map(item => {
						item.classList.remove('active')
					})
					e.target.classList.add('active')

					showLuckNum()
				}
				//æ˜¾ç¤º2
				if (choice == 2) {
					active = choice
					dynamic(choice);
					Array.from(document.getElementsByClassName('model-item')).map(item => {
						item.classList.remove('active')
					})
					e.target.classList.add('active')

					showLuckNum()
				}
				//æ˜¾ç¤ºluck
				if (choice == 3) {

					active = choice
					Array.from(document.getElementsByClassName('model-item')).map(item => {
						item.classList.remove('active')
					})
					e.target.classList.add('active')
					console.log("")
					dynamic(choice);
				}
			})


			// è·å–éšæœºå‡½æ•°
			const getRandom = (min, max) => {
				min = Math.ceil(min);
				max = Math.floor(max);
				return Math.floor(Math.random() * (max - min + 1)) + min;
			}

			// è·å–å¹¸è¿æ•°ç»„çš„æ“ä½œ
			const getGoodLuckOption = (min, max, length) => {
				return new Array(length).fill(1).reduce((prev, target) => {
					let luckyNum = getRandom(min, max)
					while (prev.includes(luckyNum)) luckyNum = getRandom(min, max)
					prev.push(luckyNum)
					return prev
				}, [])
			}

			// è·å–å¹¸è¿æ•°ç»„
			const getGoodLuck = () => {
				let o = active === '1' ? options : options2
				return {
					redList: getGoodLuckOption(1, o.redLength, o.redLuck),
					blueList: getGoodLuckOption(1, o.blueLength, o.blueLuck)
				}
			}

			// æ¸²æŸ“å·ç 
			const renderLi = (val, current = false) => {
				return `<li class="${current ? 'current' : ''}">${val}</li>`
			}

			// æ¸²æŸ“å·ç ç»„çš„æ“ä½œ
			const renderListOption = (luckList) => {
				Object.keys(luckList).forEach(item => {
					renderList(item.split('List')[0], luckList[item])
				})
			}

			// æ¸²æŸ“å·ç ç»„
			const renderList = (nodeKey, content) => {
				let o = active === '1' ? options : options2
				document.getElementById(nodeKey).innerHTML = new Array(o[`${nodeKey}Length`]).fill(1).reduce((prev, target,
					index) => {
					return prev += renderLi(index + 1, content.includes(index + 1))
				}, '')
			}

			const showLuckNum = function() {
				renderListOption(getGoodLuck())
			}

			const init = () => {
				showLuckNum()
				renderModelOption()
			}

			init()
		</script>

		<script type="text/javascript">
			//åˆ®åˆ®ä¹
			const imgSrc = 'img/gua_image.png';
			const height = 233;
			//é®ç½©çºµå‘å®½åº¦
			const width = 410.4;
			var tempKey;
			var globalJsonKey;
			var initNum;

			function randomFun() {
				if (awardsType === 1) {
					var key = getKey(tempKey, globalkeys);
					$("#show").empty().text(tempKey).show();
				} else {
					randomJsonKey();

				}
			}
			//è·å–éšæœºå¥–é¡¹
			function randomJsonKey() {
				//ä¿è¯keyæ•°ç»„åªèƒ½åˆå§‹åŒ–ä¸€æ¬¡
				if (globalJsonKey === undefined) {
					initJSONKeys();
				}
				if (globalJsonKey.length <= 0) {
					$("#show").empty().text('æ‰€æœ‰å¥–é¡¹å·²åˆ®å®Œ').show();
					alert("æ‰€æœ‰å¥–é¡¹å·²åˆ®å®Œ");
					return;
				} else {
					var key = getKey(tempKey, globalJsonKey);
					var json = globalkeys2[key];
					var awards = json.awards;
					var num = json.num;
					num = parseInt(num) - 1;
					json.num = num;
					if (num <= 0) {
						//å°†æ•°é‡å°äº0çš„åˆ é™¤
						delOneArray(globalJsonKey, key);
					}
					$("#show").empty().text(tempKey + ":" + awards).show();
				}

			}
			//åˆå§‹åŒ–éå†jsonå¯¹è±¡çš„key
			function initJSONKeys() {
				globalJsonKey = new Array();
				$.each(globalkeys2, function(index, item) {
					//console.log(index);
					if (globalJsonKey.indexOf(index) === -1) {
						globalJsonKey.push(index);
					}

				});
			}
			//åˆ é™¤æ•°ç»„ä¸­æŒ‡å®šå…ƒç´ 
			function delOneArray(array, key) {
				const idx = array.indexOf(key);
				array.splice(idx, 1);
			}

			//é¿å…å’Œä¸Šä¸€æ¬¡çš„é‡å¤
			function getKey(oldKey, keys) {

				var key = keys[Math.floor((Math.random() * keys.length))];
				if (keys.length > 1) {
					if (oldKey === key) {
						return getKey(key, keys);
					}
				}
				tempKey = key;
				return key;
			}
			$("img").load(function() {
				var body_width = $(window).width();
				var body_height = $(window).height();
				//èƒŒæ™¯å›¾å‚æ•°
				$("#gua1_img").width(0).height(250);

				$("#gua1").css({
					"margin-top": "20px"
				});
				$("#nImg").width(300).height(101);
				$("#gua").width(width / 10).height(width / 10);
				var gua1_img_width = $("#gua1_img").width();
				$("#front").css({
					"margin-top": 12 + "px",
					"margin-left": 10 + "px",
					"bolder-style": "solid",

				});
				$("#bg").width("100%").height($(window).height() - 1);
				bodys(height, width);

			});

			function bodys(height, width) {
				var img = new Image();
				var canvas = document.querySelector('canvas');
				canvas.style.position = 'absolute';
				img.addEventListener('load', function(e) {
					var ctx;
					var w = width,
						h = height;
					var offsetX = canvas.offsetLeft,
						offsetY = canvas.offsetTop;
					var mousedown = false;

					function layer(ctx) {
						ctx.fillStyle = '#E9E9EB';
						ctx.fillRect(0, 0, w, h);
					}

					function eventDown(e) {
						e.preventDefault();
						mousedown = true;
					}

					function eventUp(e) {
						e.preventDefault();
						mousedown = false;
					}

					function eventMove(e) {
						e.preventDefault();
						if (mousedown) {
							if (e.changedTouches) {
								e = e.changedTouches[e.changedTouches.length - 1];
							}
							var x = (e.clientX + document.body.scrollLeft || e.pageX) - offsetX || 0,
								y = (e.clientY + document.body.scrollTop || e.pageY) - offsetY || 0;
							with(ctx) {
								beginPath()
								arc(x, y, 50, 0, Math.PI * 2);
								fill();
							}
						}
					}
					canvas.width = w;
					canvas.height = h;
					ctx = canvas.getContext('2d');
					ctx.fillStyle = 'b9b9b9';

					ctx.fillRect(0, 0, w, h);
					layer(ctx);
					ctx.globalCompositeOperation = 'destination-out';
					canvas.addEventListener('touchstart', eventDown);
					canvas.addEventListener('touchend', eventUp);
					canvas.addEventListener('touchmove', eventMove);
					canvas.addEventListener('mousedown', eventDown);
					canvas.addEventListener('mouseup', eventUp);
					canvas.addEventListener('mousemove', eventMove);
					if (initNum === undefined) {
						initNum = 1;
						randomFun();
					}

				});

				img.src = imgSrc;
			}
			$(".resetbtn").click(function() {
				initNum = undefined;
				bodys(height, width);
			});

			// ç†æ€§å¯¹å¾… ä»…ä¾›å¨±ä¹ è¯·å‹¿ç”¨äºä»»ä½•å•†ä¸šç”¨é€”Powered by molifei &Thanks SmileFuture contactï¼š nkgiycnup@mozmail.com
		</script>

	</body>
</html>